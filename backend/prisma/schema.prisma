// Este archivo define el esquema de la base de datos para Prisma
// Ejecuta: npx prisma migrate dev --name init para crear la base de datos

model Escuela {
  id        Int        @id @default(autoincrement())
  nombre    String
  direccion String
  turno     String

  aulas     Aula[]
  docentes  Docente[]
  estudiantes Estudiante[]
}

model Aula {
  id        Int     @id @default(autoincrement())
  nombre    String
  grado     String

  escuelaId Int
  escuela   Escuela @relation(fields: [escuelaId], references: [id])

  docenteId Int
  
  docente   Docente @relation(fields: [docenteId], references: [id])

  estudiantes Estudiante[]
}

model Docente {
  id        Int     @id @default(autoincrement())
  nombre    String
  email     String  @unique
  clases    String
  grados    String
  horario   String
  rol       String

  escuelaId Int
  escuela   Escuela @relation(fields: [escuelaId], references: [id])

  aulas     Aula[]
  estudiantes Estudiante[]
  misiones  Mision[]
  perfil Perfil[]
}

model Estudiante {
  id        Int     @id @default(autoincrement())
  nombre    String
  email     String  @unique
  edad      Int
  grado     String
  horario   String

  escuelaId Int
  escuela   Escuela @relation(fields: [escuelaId], references: [id])

  docenteId Int
  docente   Docente @relation(fields: [docenteId], references: [id])

  aulaId Int
  aula   Aula @relation(fields: [aulaId], references: [id])

  skillTree SkillTree?
  asignatura Asignatura?
  perfil Perfil[]
}

model SkillTree {
  id           Int     @id @default(autoincrement())
  progreso     Int     @default(0)   // % completado
  xp           Int     @default(0)   // experiencia acumulada
  estudianteId Int     @unique
  estudiante   Estudiante @relation(fields: [estudianteId], references: [id])
}

model Asignatura {
  id        Int     @id @default(autoincrement())
  nombre    String
  descripcion String

  estudianteId Int     @unique
  estudiante Estudiante @relation(fields: [estudianteId], references: [id])
}

model Mision {
  id        Int     @id @default(autoincrement())
  titulo    String
  descripcion String
  estado    String
  grado     String

  docenteId Int
  docente   Docente @relation(fields: [docenteId], references: [id])
}

model Perfil {
  id           Int     @id @default(autoincrement())
  fotoPerfil   String?
  exp          Int     @default(0)   // EXP global
  monedas      Int     @default(0)

  estudianteId Int    @unique
  estudiante   Estudiante @relation(fields: [estudianteId], references: [id])

  docenteId    Int   @unique
  docente      Docente @relation(fields: [docenteId], references: [id])
}
