generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id            Int              @id @default(autoincrement())
  firstName     String
  lastName      String
  name          String           // Nombre completo (para compatibilidad)
  role          String           // "docente" o "alumno"
  email         String           @unique
  password      String
  xp            Int              @default(0)
  level         Int              @default(1)
  missions      Mission[]        @relation("StudentMissions")
  notifications Notification[]   @relation("UserNotifications")
  lastActivity  DateTime         @default(now())
  createdAt     DateTime         @default(now())
}

model Mission {
  id             Int      @id @default(autoincrement())
  title          String
  description    String
  subject        String   @default("General") // Asignatura: Matemáticas, Lengua, etc.
  dueDate        DateTime
  timeLimit      String   @default("23:59") // Hora límite en formato HH:MM
  activationDate DateTime @default(now()) // Fecha de publicación
  status         String   @default("activa") // "activa" o "cerrada"
  students       User[]   @relation("StudentMissions")
  createdAt      DateTime @default(now())
}

model Notification {
  id          Int      @id @default(autoincrement())
  message     String
  createdAt   DateTime @default(now())
  read        Boolean  @default(false)
  recipientId Int
  recipient   User     @relation(fields: [recipientId], references: [id], name: "UserNotifications")
}

